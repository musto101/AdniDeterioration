2014:2022
data.frame(job_num = 1:8, salary = c(30000, 35000, 45000, 5000, 55000, 65000, 125000, 90000))
data.frame(job_num = 1:9, salary = c(30000, 35000, 45000, 5000, 55000, 65000, 125000, 90000))
data.frame(job_num = 1:8,
salary = c(30000, 35000, 45000, 50000, 55000, 65000, 125000, 90000))
earnings <- data.frame(job_num = 1:8,
salary = c(30000, 35000, 45000, 50000, 55000, 65000, 125000, 90000))
year <- (2014, 2015, 2017, 2018, 2019, 2020, 2021, 2022)
year <- c(2014, 2015, 2017, 2018, 2019, 2020, 2021, 2022)
earnings <- data.frame(job_num = 1:8,
year = c(2014, 2015, 2017, 2018, 2019, 2020, 2021, 2022),
salary = c(30000, 35000, 45000, 50000, 55000, 65000,
125000, 90000))
fit <- lm(salary ~., earnings)
summary(fit)
plot(year, salary)
plot(earnings$year, earnings$salary)
abline(fit)
earnings <- data.frame(job_num = 1:8,
year = c(2014, 2015, 2017, 2018, 2019, 2020, 2021, 2022),
salary = c(30000, 35000, 45000, 50000, 55000, 65000,
87000, 90000))
fit <- lm(salary ~., earnings)
summary(fit)
plot(earnings$year, earnings$salary)
abline(fit)
abline(fit$coefficients)
library(car)
install.packages(car)
install.packages('car')
library(car)
avPlots(fit)
View(earnings)
summary(fit)
fit <- lm(salary ~ year, earnings)
summary(fit)
plot(year, salary)
plot(earnings$year, earnings$salary)
abline(fit)
test <- 2026
predict(fit, test)
test <- data.frame(year = 2026)
predict(fit, test)
fit <- lm(salary ~ year + year ^ 2, earnings)
summary(fit)
plot(earnings$year, earnings$salary)
abline(fit)
fit <- lm(salary ~ year + year^2, earnings)
summary(fit)
plot(earnings$year, earnings$salary)
abline(fit)
test <- data.frame(year = 2026)
predict(fit, test)
fit <- lm(salary ~ year + poly(year, 2), earnings)
summary(fit)
plot(earnings$year, earnings$salary)
abline(fit)
test <- data.frame(year = 2026)
predict(fit, test)
#use model to get predicted values
pred <- predict(fit)
ix <- sort(x, index.return=T)$ix
#add polynomial curve to plot
lines(x[ix], pred[ix], col='red', lwd=2)
#use model to get predicted values
plot(earnings$year, earnings$salary, pch=16, cex=1.5)
#use model to get predicted values
pred <- predict(fit)
ix <- sort(earnings$year, index.return=T)$ix
#add polynomial curve to plot
lines(earnings$year[ix], pred[ix], col='red', lwd=2)
test <- data.frame(year = 2026)
predict(fit, test)
test <- data.frame(year = 2049)
predict(fit, test)
test <- data.frame(year = 2023:2049)
View(test)
pred <- predict(fit, test)
plot(test$year, pred)
options(scipen = 10000)
plot(test$year, pred)
plot(test$year, pred, type = 'l')
df %>%
ggplot(aes(x=test$year, y=pred)) +
geom_line()+
scale_y_continuous(labels=scales::dollar_format())
library(ggplot2)
ggplot(aes(x=test$year, y=pred)) + geom_line()+
scale_y_continuous(labels=scales::dollar_format())
predicted <- data.frame(year = test$year, predicted_salary = pred)
ggplot(predicted, aes(x = year, y = predicted_salary)) + geom_line()+
scale_y_continuous(labels=scales::dollar_format())
ggplot(predicted, aes(x = year, y = predicted_salary)) + geom_line()+
scale_y_continuous(labels=scales::pound_format())
ggplot(predicted, aes(x = year, y = predicted_salary)) + geom_line()+
scale_y_continuous(labels=scales::dollar_format(suffix = '£'))
ggplot(predicted, aes(x = year, y = predicted_salary)) + geom_line()+
scale_y_continuous(labels=scales::dollar_format(prefix = '£'))
fit2 <- lm(salary ~ year, earnings)
pred2 <- predict(fit2, test)
predicted2 <- data.frame(year = test$year, predicted_salary = pred2)
View(predicted2)
View(predicted2)
